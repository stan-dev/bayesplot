<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!-- upstream: inst/BS5/templates/head.html; pkgdown-version: 2.1.3, fe04924 --><!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 --><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Plotting MCMC draws using the bayesplot package • bayesplot</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@4.0.0/tex-mml-chtml.js" integrity="sha256-qoRlVrS5NAnXSSSiMfFXwK8C9obG11Iybe4h2+bQYR4=" crossorigin="anonymous">
  </script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_3-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome 7.0.1 for Bluesky icon --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" referrerpolicy="no-referrer">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plotting MCMC draws using the bayesplot package">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <!-- upstream: inst/BS5/templates/navbar.html; pkgdown-version: 2.1.3, fe04924 -->
<!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 -->
<nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">


    <a class="navbar-brand me-2" href="../index.html">
      <!-- Add Stan logo -->
      <picture><source type="image/svg+xml" srcset="../logo.svg"><img src="../logo.png" class="stan-logo" alt="Stan blue hex logo"></source></picture>
      bayesplot
    </a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.15.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Go to homepage"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages">
<li><a class="external-link dropdown-item" href="https://mc-stan.org/cmdstanr">cmdstanr</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/loo">loo</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/posterior">posterior</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/projpred">projpred</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstan">rstan</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstanarm">rstanarm</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstantools">rstantools</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/shinystan">shinystan</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://mc-stan.org/about/">About Stan</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/did:plc:qznndgdnkem2yryu7ipqbpv7" aria-label="Visit our Bluesky profile"><span class="fa fa-brands fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://discourse.mc-stan.org/" aria-label="Visit our forums"><span class="fa fa-users"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stan-dev/bayesplot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Plotting MCMC draws using the bayesplot package</h1>
                        <h4 data-toc-skip class="author">Jonah
Gabry</h4>
            
            <h4 data-toc-skip class="date">2025-12-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/bayesplot/blob/master/vignettes/plotting-mcmc-draws.Rmd" class="external-link"><code>vignettes/plotting-mcmc-draws.Rmd</code></a></small>
      <div class="d-none name"><code>plotting-mcmc-draws.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette focuses on plotting parameter estimates from MCMC
draws. MCMC diagnostic plots are covered in the separate vignette <a href="https://mc-stan.org/bayesplot/articles/visual-mcmc-diagnostics.html"><em>Visual
MCMC diagnostics</em></a>, and graphical posterior predictive model
checking is covered in the vignette <a href="https://mc-stan.org/bayesplot/articles/graphical-ppcs.html"><em>Graphical
posterior predictive checks</em></a>.</p>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>In addition to <strong>bayesplot</strong> we’ll load the following
packages:</p>
<ul>
<li>
<strong>ggplot2</strong>, in case we want to customize the ggplot
objects created by <strong>bayesplot</strong>
</li>
<li>
<strong>rstanarm</strong>, for fitting the example models used
throughout the vignette</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mc-stan.org/bayesplot/">"bayesplot"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://mc-stan.org/rstanarm/" class="external-link">"rstanarm"</a></span><span class="op">)</span>      </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-model">Example model<a class="anchor" aria-label="anchor" href="#example-model"></a>
</h3>
<p>The <strong>bayesplot</strong> package provides various plotting
functions for visualizing Markov chain Monte Carlo (MCMC) draws from the
posterior distribution of the parameters of a Bayesian model. In this
vignette we demonstrate a few of these functions. Example usage of the
functions not demonstrated here can be found in the package
documentation.</p>
<p>For demonstration we will use draws obtained using the
<code>stan_glm</code> function in the <strong>rstanarm</strong> package
(Gabry and Goodrich, 2017), but MCMC draws from using any package can be
used with the functions in the <strong>bayesplot</strong> package. See,
for example, <strong>brms</strong>, which, like
<strong>rstanarm</strong>, calls the <strong>rstan</strong> package
internally to use <a href="https://mc-stan.org/" class="external-link">Stan</a>’s MCMC
sampler.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span> <span class="co"># see help("mtcars")</span></span></code></pre></div>
<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># linear regression model using stan_glm</span></span>
<span><span class="co"># using '~ .' to include all variables</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_glm.html" class="external-link">stan_glm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">mtcars</span>, seed <span class="op">=</span> <span class="fl">1111</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<pre><code>stan_glm
 family:       gaussian [identity]
 formula:      mpg ~ .
 observations: 32
 predictors:   11
------
            Median MAD_SD
(Intercept) 12.0   19.3  
cyl         -0.1    1.1  
disp         0.0    0.0  
hp           0.0    0.0  
drat         0.8    1.6  
wt          -3.7    1.9  
qsec         0.8    0.8  
vs           0.3    2.1  
am           2.6    2.1  
gear         0.6    1.5  
carb        -0.2    0.9  

Auxiliary parameter(s):
      Median MAD_SD
sigma 2.7    0.4   

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>To use the posterior draws with the functions in the
<strong>bayesplot</strong> package we’ll extract them from the fitted
model object:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">posterior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">as.array</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 1000    4   12</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">posterior</span><span class="op">)</span></span></code></pre></div>
<pre><code>$iterations
NULL

$chains
[1] "chain:1" "chain:2" "chain:3" "chain:4"

$parameters
 [1] "(Intercept)" "cyl"         "disp"        "hp"          "drat"       
 [6] "wt"          "qsec"        "vs"          "am"          "gear"       
[11] "carb"        "sigma"      </code></pre>
<p>We’ve used <code>as.array</code> above (as opposed to
<code>as.matrix</code>) because it keeps the Markov chains separate
(<code>stan_glm</code> runs four chains by default). Most of the plots
don’t actually need the chains to be separate, but for a few of the
plots we make in this vignette we’ll want to show the chains
individually.</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="posterior-uncertainty-intervals">Posterior uncertainty intervals<a class="anchor" aria-label="anchor" href="#posterior-uncertainty-intervals"></a>
</h2>
<p>For models fit using MCMC we can compute posterior uncertainty
intervals (sometimes called “credible intervals”) in various ways.
<strong>bayesplot</strong> currently provides plots of central intervals
based on quantiles, although additional options may be provided in
future releases (e.g., HDIs, which can be useful in particular
cases).</p>
<p><strong>Documentation:</strong></p>
<ul>
<li><code><a href="../reference/MCMC-intervals.html">help("MCMC-intervals")</a></code></li>
<li><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html">mc-stan.org/bayesplot/reference/MCMC-intervals</a></li>
</ul>
<hr>
<div class="section level4">
<h4 id="mcmc_intervals-mcmc_areas">mcmc_intervals, mcmc_areas<a class="anchor" aria-label="anchor" href="#mcmc_intervals-mcmc_areas"></a>
</h4>
<p>Central posterior uncertainty intervals can be plotted using the
<code>mcmc_intervals</code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/MCMC-intervals.html">mcmc_intervals</a></span><span class="op">(</span><span class="va">posterior</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cyl"</span>, <span class="st">"drat"</span>, <span class="st">"am"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_intervals-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
<p>The default is to show 50% intervals (the thick segments) and 90%
intervals (the thinner outer lines). These defaults can be changed using
the <code>prob</code> and <code>prob_outer</code> arguments,
respectively. The points in the above plot are posterior medians. The
<code>point_est</code> argument can be used to select posterior means
instead or to omit the point estimates.</p>
<p>To show the uncertainty intervals as shaded areas under the estimated
posterior density curves we can use the <code>mcmc_areas</code>
function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MCMC-intervals.html">mcmc_areas</a></span><span class="op">(</span></span>
<span>  <span class="va">posterior</span>, </span>
<span>  pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cyl"</span>, <span class="st">"drat"</span>, <span class="st">"am"</span>, <span class="st">"sigma"</span><span class="op">)</span>,</span>
<span>  prob <span class="op">=</span> <span class="fl">0.8</span>, <span class="co"># 80% intervals</span></span>
<span>  prob_outer <span class="op">=</span> <span class="fl">0.99</span>, <span class="co"># 99%</span></span>
<span>  point_est <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_areas-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="univariate-marginal-posterior-distributions">Univariate marginal posterior distributions<a class="anchor" aria-label="anchor" href="#univariate-marginal-posterior-distributions"></a>
</h2>
<p><strong>bayesplot</strong> provides functions for looking at
histograms or kernel density estimates of marginal posterior
distributions, either with all Markov chains combined or with the chains
separate.</p>
<p><strong>Documentation:</strong></p>
<ul>
<li><code><a href="../reference/MCMC-distributions.html">help("MCMC-distributions")</a></code></li>
<li><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html">mc-stan.org/bayesplot/reference/MCMC-distributions</a></li>
</ul>
<hr>
<div class="section level4">
<h4 id="mcmc_hist">mcmc_hist<a class="anchor" aria-label="anchor" href="#mcmc_hist"></a>
</h4>
<p>The <code>mcmc_hist</code> function plots marginal posterior
distributions (combining all chains):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span><span class="op">(</span><span class="st">"green"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/MCMC-distributions.html">mcmc_hist</a></span><span class="op">(</span><span class="va">posterior</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wt"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_hist-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
<p>If we want to plot <code>log(sigma)</code> rather than
<code>sigma</code> we can either transform the draws in advance or use
the <code>transformations</code> argument.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span><span class="op">(</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/MCMC-distributions.html">mcmc_hist</a></span><span class="op">(</span><span class="va">posterior</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wt"</span>, <span class="st">"sigma"</span><span class="op">)</span>,</span>
<span>          transformations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"sigma"</span> <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_hist-transform-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
<!-- ```{r mcmc_hist-transform, message=FALSE, eval=FALSE} -->
<!-- # not evaluated to reduce vignette size for CRAN -->
<!-- # full version available at mc-stan.org/bayesplot/articles -->
<!-- color_scheme_set("blue") -->
<!-- mcmc_hist(posterior, pars = c("wt", "sigma"), -->
<!--           transformations = list("sigma" = "log")) -->
<!-- ``` -->
<p>Most of the other functions for plotting MCMC draws also have a
<code>transformations</code> argument.</p>
</div>
<div class="section level4">
<h4 id="mcmc_hist_by_chain">mcmc_hist_by_chain<a class="anchor" aria-label="anchor" href="#mcmc_hist_by_chain"></a>
</h4>
<p>To view separate histograms of each of the four Markov chains we can
use <code>mcmc_hist_by_chain</code>, which plots each chain in a
separate facet in the plot.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span><span class="op">(</span><span class="st">"brightblue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/MCMC-distributions.html">mcmc_hist_by_chain</a></span><span class="op">(</span><span class="va">posterior</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wt"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_hist_by_chain-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="mcmc_dens">mcmc_dens<a class="anchor" aria-label="anchor" href="#mcmc_dens"></a>
</h4>
<p>The <code>mcmc_dens</code> function is similar to
<code>mcmc_hist</code> but plots kernel density estimates instead of
histograms.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span><span class="op">(</span><span class="st">"purple"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/MCMC-distributions.html">mcmc_dens</a></span><span class="op">(</span><span class="va">posterior</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wt"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_dens-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="mcmc_dens_overlay">mcmc_dens_overlay<a class="anchor" aria-label="anchor" href="#mcmc_dens_overlay"></a>
</h4>
<p>Like <code>mcmc_hist_by_chain</code>, the
<code>mcmc_dens_overlay</code> function separates the Markov chains. But
instead of plotting each chain individually, the density estimates are
overlaid.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MCMC-distributions.html">mcmc_dens_overlay</a></span><span class="op">(</span><span class="va">posterior</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wt"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_dens_overlay-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="mcmc_violin">mcmc_violin<a class="anchor" aria-label="anchor" href="#mcmc_violin"></a>
</h4>
<p>The <code>mcmc_violin</code> function plots the density estimates of
each chain as violins and draws horizontal line segments at
user-specified quantiles.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span><span class="op">(</span><span class="st">"teal"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/MCMC-distributions.html">mcmc_violin</a></span><span class="op">(</span><span class="va">posterior</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wt"</span>, <span class="st">"sigma"</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_violin-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="bivariate-plots">Bivariate plots<a class="anchor" aria-label="anchor" href="#bivariate-plots"></a>
</h2>
<p>Various functions are available for plotting bivariate marginal
posterior distributions. Some of these functions also take optional
arguments for adding MCMC diagnostic information to the plots. That
additional functionality is discussed in the separate <a href="https://mc-stan.org/bayesplot/articles/visual-mcmc-diagnostics.html"><em>Visual
MCMC diagnostics</em></a> vignette.</p>
<p><strong>Documentation:</strong></p>
<ul>
<li><code><a href="../reference/MCMC-scatterplots.html">help("MCMC-scatterplots")</a></code></li>
<li><a href="https://mc-stan.org/bayesplot/reference/MCMC-scatterplots.html">mc-stan.org/bayesplot/reference/MCMC-scatterplots</a></li>
</ul>
<hr>
<div class="section level4">
<h4 id="mcmc_scatter">mcmc_scatter<a class="anchor" aria-label="anchor" href="#mcmc_scatter"></a>
</h4>
<p>The <code>mcmc_scatter</code> function creates a simple scatterplot
of two parameters.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span><span class="op">(</span><span class="st">"gray"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/MCMC-scatterplots.html">mcmc_scatter</a></span><span class="op">(</span><span class="va">posterior</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(Intercept)"</span>, <span class="st">"wt"</span><span class="op">)</span>, </span>
<span>             size <span class="op">=</span> <span class="fl">1.5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_scatter-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="mcmc_hex">mcmc_hex<a class="anchor" aria-label="anchor" href="#mcmc_hex"></a>
</h4>
<p>The <code>mcmc_hex</code> function creates a similar plot but using
hexagonal binning, which can be useful to avoid overplotting.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># requires hexbin package</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"hexbin"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/MCMC-scatterplots.html">mcmc_hex</a></span><span class="op">(</span><span class="va">posterior</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(Intercept)"</span>, <span class="st">"wt"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_hex-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="mcmc_pairs">mcmc_pairs<a class="anchor" aria-label="anchor" href="#mcmc_pairs"></a>
</h4>
<p>In addition to <code>mcmc_scatter</code> and <code>mcmc_hex</code>,
<strong>bayesplot</strong> now provides an <code>mcmc_pairs</code>
function for creating pairs plots with more than two parameters.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span><span class="op">(</span><span class="st">"pink"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/MCMC-scatterplots.html">mcmc_pairs</a></span><span class="op">(</span><span class="va">posterior</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(Intercept)"</span>, <span class="st">"wt"</span>, <span class="st">"sigma"</span><span class="op">)</span>,</span>
<span>           off_diag_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_pairs-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
<!-- ```{r mcmc_pairs, message=FALSE, eval=FALSE} -->
<!-- # not evaluated to reduce vignette size for CRAN -->
<!-- # full version available at mc-stan.org/bayesplot/articles -->
<!-- color_scheme_set("pink") -->
<!-- mcmc_pairs(posterior, pars = c("(Intercept)", "wt", "sigma"), -->
<!--            off_diag_args = list(size = 1.5)) -->
<!-- ``` -->
<p>The univariate marginal posteriors are shown along the diagonal as
histograms, but this can be changed to densities by setting
<code>diag_fun="dens"</code>. Bivariate plots are displayed above and
below the diagonal as scatterplots, but it is also possible to use hex
plots by setting <code>off_diag_fun="hex"</code>. By default,
<code>mcmc_pairs</code> shows some of the Markov chains (half, if an
even number of chains) above the diagonal and the others below. There
are many more options for controlling how the draws should be split
between the plots above and below the diagonal (see the documentation
for the <code>condition</code> argument), but they are more useful when
MCMC diagnostic information is included. This is discussed in the <a href="https://mc-stan.org/bayesplot/articles/visual-mcmc-diagnostics.html"><em>Visual
MCMC diagnostics</em></a> vignette.</p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="trace-plots">Trace plots<a class="anchor" aria-label="anchor" href="#trace-plots"></a>
</h2>
<p>Trace plots are time series plots of Markov chains. In this vignette
we show the standard trace plots that <strong>bayesplot</strong> can
make. For models fit using any Stan interface (or Hamiltonian Monte
Carlo in general), the <a href="https://mc-stan.org/bayesplot/articles/visual-mcmc-diagnostics.html"><em>Visual
MCMC diagnostics</em></a> vignette provides an example of also adding
information about divergences to trace plots.</p>
<p><strong>Documentation:</strong></p>
<ul>
<li><code><a href="../reference/MCMC-traces.html">help("MCMC-traces")</a></code></li>
<li><a href="https://mc-stan.org/bayesplot/reference/MCMC-traces.html">mc-stan.org/bayesplot/reference/MCMC-traces</a></li>
</ul>
<hr>
<div class="section level4">
<h4 id="mcmc_trace">mcmc_trace<a class="anchor" aria-label="anchor" href="#mcmc_trace"></a>
</h4>
<p>The <code>mcmc_trace</code> function creates standard trace
plots:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span><span class="op">(</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/MCMC-traces.html">mcmc_trace</a></span><span class="op">(</span><span class="va">posterior</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wt"</span>, <span class="st">"sigma"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_trace-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
<p>If it’s hard to see the difference between the chains we can change
to a mixed color scheme, for example:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span><span class="op">(</span><span class="st">"mix-blue-red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/MCMC-traces.html">mcmc_trace</a></span><span class="op">(</span><span class="va">posterior</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wt"</span>, <span class="st">"sigma"</span><span class="op">)</span>, </span>
<span>           facet_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">1</span>, strip.position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/change-scheme-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
<p>The code above also illustrates the use of the
<code>facet_args</code> argument, which is a list of parameters passed
to <code>facet_wrap</code> in <strong>ggplot2</strong>. Specifying
<code>ncol=1</code> means the trace plots will be stacked in a single
column rather than placed side by side, and
<code>strip.position="left"</code> moves the facet labels to the y-axis
(instead of above each facet).</p>
<p>The <a href="https://CRAN.R-project.org/package=viridis" class="external-link"><code>"viridis"</code>
color scheme</a> is also useful for trace plots because it is comprised
of very distinct colors:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span><span class="op">(</span><span class="st">"viridis"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/MCMC-traces.html">mcmc_trace</a></span><span class="op">(</span><span class="va">posterior</span>, pars <span class="op">=</span> <span class="st">"(Intercept)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/viridis-scheme-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
<!-- ```{r viridis-scheme, eval=FALSE} -->
<!-- # not evaluated to reduce vignette size for CRAN -->
<!-- # full version available at mc-stan.org/bayesplot/articles -->
<!-- color_scheme_set("viridis") -->
<!-- mcmc_trace(posterior, pars = "(Intercept)") -->
<!-- ``` -->
</div>
<div class="section level4">
<h4 id="mcmc_trace_highlight">mcmc_trace_highlight<a class="anchor" aria-label="anchor" href="#mcmc_trace_highlight"></a>
</h4>
<p>The <code>mcmc_trace_highlight</code> function uses points instead of
lines and reduces the opacity of all but a single chain (which is
specified using the <code>highlight</code> argument).</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MCMC-traces.html">mcmc_trace_highlight</a></span><span class="op">(</span><span class="va">posterior</span>, pars <span class="op">=</span> <span class="st">"sigma"</span>, highlight <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_trace_highlight-1.png" class="r-plt" width="60%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Gabry, J., and Goodrich, B. (2017). rstanarm: Bayesian Applied
Regression Modeling via Stan. R package version 2.15.3. <a href="https://mc-stan.org/rstanarm/" class="external-link uri">https://mc-stan.org/rstanarm/</a>, <a href="https://CRAN.R-project.org/package=rstanarm" class="external-link uri">https://CRAN.R-project.org/package=rstanarm</a></p>
<p>Gabry, J., Simpson, D., Vehtari, A., Betancourt, M. and Gelman, A.
(2019), Visualization in Bayesian workflow. <em>J. R. Stat. Soc. A</em>,
182: 389-402. :10.1111/rssa.12378. (<a href="https://rss.onlinelibrary.wiley.com/doi/full/10.1111/rssa.12378" class="external-link">journal
version</a>, <a href="https://arxiv.org/abs/1709.01449" class="external-link">arXiv
preprint</a>, <a href="https://github.com/jgabry/bayes-vis-paper" class="external-link">code
on GitHub</a>) <a id="gabry2019"></a></p>
<p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A.,
and Rubin, D. B. (2013). <em>Bayesian Data Analysis</em>. Chapman &amp;
Hall/CRC Press, London, third edition.</p>
<p>Stan Development Team. (2017). <em>Stan Modeling Language Users Guide
and Reference Manual</em>. <a href="https://mc-stan.org/users/documentation/" class="external-link uri">https://mc-stan.org/users/documentation/</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonah Gabry, Tristan Mahr.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
