<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- upstream: inst/BS5/templates/head.html; pkgdown-version: 2.1.3, fe04924 --><!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 --><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>PPCs for discrete outcomes — PPC-discrete • bayesplot</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@4.0.0/tex-mml-chtml.js" integrity="sha256-qoRlVrS5NAnXSSSiMfFXwK8C9obG11Iybe4h2+bQYR4=" crossorigin="anonymous">
  </script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_3-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- Font Awesome 7.0.1 for Bluesky icon --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css" referrerpolicy="no-referrer"><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PPCs for discrete outcomes — PPC-discrete"><meta name="description" content="Many of the PPC functions in bayesplot can
be used with discrete data. The small subset of these functions that can
only be used if y and yrep are discrete are documented
on this page. Currently these include rootograms for count outcomes and bar
plots for ordinal, categorical, and multinomial outcomes. See the
Plot Descriptions section below."><meta property="og:description" content="Many of the PPC functions in bayesplot can
be used with discrete data. The small subset of these functions that can
only be used if y and yrep are discrete are documented
on this page. Currently these include rootograms for count outcomes and bar
plots for ordinal, categorical, and multinomial outcomes. See the
Plot Descriptions section below."><meta property="og:image" content="https://mc-stan.org/bayesplot/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <!-- upstream: inst/BS5/templates/navbar.html; pkgdown-version: 2.1.3, fe04924 -->
<!-- https://github.com/r-lib/pkgdown/tree/fe04924b3df129bea60ac871614b01d87bcae147 -->
<nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">


    <a class="navbar-brand me-2" href="../index.html">
      <!-- Add Stan logo -->
      <picture><source type="image/svg+xml" srcset="../logo.svg"><img src="../logo.png" class="stan-logo" alt="Stan blue hex logo"></source></picture>
      bayesplot
    </a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.15.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Go to homepage"><span class="fa fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-other-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Other Packages</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-other-packages"><li><a class="external-link dropdown-item" href="https://mc-stan.org/cmdstanr">cmdstanr</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/loo">loo</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/posterior">posterior</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/projpred">projpred</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstan">rstan</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstanarm">rstanarm</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/rstantools">rstantools</a></li>
    <li><a class="external-link dropdown-item" href="https://mc-stan.org/shinystan">shinystan</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mc-stan.org/about/">About Stan</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://bsky.app/profile/did:plc:qznndgdnkem2yryu7ipqbpv7" aria-label="Visit our Bluesky profile"><span class="fa fa-brands fa-bluesky"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://discourse.mc-stan.org/" aria-label="Visit our forums"><span class="fa fa-users"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stan-dev/bayesplot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>PPCs for discrete outcomes</h1>
      <small class="dont-index">Source: <a href="https://github.com/stan-dev/bayesplot/blob/v1.15.0/R/ppc-discrete.R" class="external-link"><code>R/ppc-discrete.R</code></a></small>
      <div class="d-none name"><code>PPC-discrete.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Many of the <a href="PPC-overview.html">PPC</a> functions in <strong>bayesplot</strong> can
be used with discrete data. The small subset of these functions that can
<em>only</em> be used if <code>y</code> and <code>yrep</code> are discrete are documented
on this page. Currently these include rootograms for count outcomes and bar
plots for ordinal, categorical, and multinomial outcomes. See the
<strong>Plot Descriptions</strong> section below.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ppc_bars</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">yrep</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  prob <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  fatten <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  linewidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  freq <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ppc_bars_grouped</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">yrep</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  facet_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  prob <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  fatten <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  linewidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  freq <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ppc_rootogram</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">yrep</span>,</span>
<span>  style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"standing"</span>, <span class="st">"hanging"</span>, <span class="st">"suspended"</span>, <span class="st">"discrete"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  prob <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bound_distinct <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ppc_bars_data</span><span class="op">(</span><span class="va">y</span>, <span class="va">yrep</span>, group <span class="op">=</span> <span class="cn">NULL</span>, prob <span class="op">=</span> <span class="fl">0.9</span>, freq <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A vector of observations. See <strong>Details</strong>.</p></dd>


<dt id="arg-yrep">yrep<a class="anchor" aria-label="anchor" href="#arg-yrep"></a></dt>
<dd><p>An <code>S</code> by <code>N</code> matrix of draws from the posterior (or prior)
predictive distribution. The number of rows, <code>S</code>, is the size of the
posterior (or prior) sample used to generate <code>yrep</code>. The number of columns,
<code>N</code> is the number of predicted observations (<code>length(y)</code>). The columns of
<code>yrep</code> should be in the same order as the data points in <code>y</code> for the plots
to make sense. See the <strong>Details</strong> and <strong>Plot Descriptions</strong> sections for
additional advice specific to particular plots.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Currently unused.</p></dd>


<dt id="arg-prob">prob<a class="anchor" aria-label="anchor" href="#arg-prob"></a></dt>
<dd><p>A value between <code>0</code> and <code>1</code> indicating the desired probability
mass to include in the <code>yrep</code> intervals. Set <code>prob=0</code> to remove the
intervals. (Note: for rootograms these are intervals of the <em>square roots</em>
of the expected counts.)</p></dd>


<dt id="arg-width">width<a class="anchor" aria-label="anchor" href="#arg-width"></a></dt>
<dd><p>For bar plots only, passed to <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">ggplot2::geom_bar()</a></code> to control
the bar width.</p></dd>


<dt id="arg-size-fatten-linewidth">size, fatten, linewidth<a class="anchor" aria-label="anchor" href="#arg-size-fatten-linewidth"></a></dt>
<dd><p>For bar plots, <code>size</code>, <code>fatten</code>, and <code>linewidth</code>
are passed to <code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">ggplot2::geom_pointrange()</a></code> to control the appearance of the
<code>yrep</code> points and intervals. For rootograms <code>size</code> is passed to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">ggplot2::geom_line()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">ggplot2::geom_pointrange()</a></code>.</p></dd>


<dt id="arg-freq">freq<a class="anchor" aria-label="anchor" href="#arg-freq"></a></dt>
<dd><p>For bar plots only, if <code>TRUE</code> (the default) the y-axis will
display counts. Setting <code>freq=FALSE</code> will put proportions on the y-axis.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>A grouping variable of the same length as <code>y</code>.
Will be coerced to <a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a> if not already a factor.
Each value in <code>group</code> is interpreted as the group level pertaining
to the corresponding observation.</p></dd>


<dt id="arg-facet-args">facet_args<a class="anchor" aria-label="anchor" href="#arg-facet-args"></a></dt>
<dd><p>An optional list of  arguments (other than <code>facets</code>)
passed to <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">ggplot2::facet_wrap()</a></code> to control faceting.</p></dd>


<dt id="arg-style">style<a class="anchor" aria-label="anchor" href="#arg-style"></a></dt>
<dd><p>For <code>ppc_rootogram</code>, a string specifying the rootogram
style. The options are <code>"discrete"</code>, <code>"standing"</code>, <code>"hanging"</code>, and
<code>"suspended"</code>. See the <strong>Plot Descriptions</strong> section, below, for
details on the different styles.</p></dd>


<dt id="arg-bound-distinct">bound_distinct<a class="anchor" aria-label="anchor" href="#arg-bound-distinct"></a></dt>
<dd><p>For <code>ppc_rootogram(style = "discrete)</code>,
if <code>TRUE</code> then the observed counts will be plotted with different shapes
depending on whether they are within the bounds of the <code>y</code> quantiles.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The plotting functions return a ggplot object that can be further
customized using the <strong>ggplot2</strong> package. The functions with suffix
<code>_data()</code> return the data that would have been drawn by the plotting
function.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For all of these plots <code>y</code> and <code>yrep</code> must be integers, although
they need not be integers in the strict sense of <span style="R">R</span>'s
<a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a> type. For rootogram plots <code>y</code> and <code>yrep</code> must also
be non-negative.</p>
    </div>
    <div class="section level2">
    <h2 id="plot-descriptions">Plot Descriptions<a class="anchor" aria-label="anchor" href="#plot-descriptions"></a></h2>


<dl><dt><code>ppc_bars()</code></dt>
<dd><p>Bar plot of <code>y</code> with <code>yrep</code> medians and uncertainty intervals
superimposed on the bars.</p></dd>

<dt><code>ppc_bars_grouped()</code></dt>
<dd><p>Same as <code>ppc_bars()</code> but a separate plot (facet) is generated for each
level of a grouping variable.</p></dd>

<dt><code>ppc_rootogram()</code></dt>
<dd><p>Rootograms allow for diagnosing problems in count data models such as
overdispersion or excess zeros. In <code>standing</code>, <code>hanging</code>, and <code>suspended</code>
styles, they consist of a histogram of <code>y</code> with the expected counts based on
<code>yrep</code> overlaid as a line along with uncertainty intervals.</p>
<p>Meanwhile, in <code>discrete</code> style, median counts based on <code>yrep</code> are laid
as a point range with uncertainty intervals along with dots
representing the <code>y</code>.</p>
<p>The y-axis represents the square roots of the counts to approximately
adjust for scale differences and thus ease comparison between observed
and expected counts. Using the <code>style</code> argument, the rootogram can be
adjusted to focus on different aspects of the data:</p><ul><li><p><em>Standing</em>: basic histogram of observed counts with curve
showing expected counts.</p></li>
<li><p><em>Hanging</em>: observed counts hanging from the curve
representing expected counts.</p></li>
<li><p><em>Suspended</em>: histogram of the differences between expected and
observed counts.</p></li>
<li><p><em>Discrete</em>: a dot-and-whisker plot of the median counts and
dots representing observed counts.</p></li>
</ul><p>As it emphasizes the discrete nature of the count data,
using <code>discrete</code> style is suggested.</p>
<p><strong>All of the rootograms are plotted on the square root scale</strong>. See Kleiber
and Zeileis (2016) for advice on interpreting rootograms and selecting
among the different styles.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="related-functions">Related functions<a class="anchor" aria-label="anchor" href="#related-functions"></a></h2>


<p>In addition to the functions on this page that are restricted to discrete
outcomes, some general PPC/PPD functions also support discrete data
when requested:</p><ul><li><p><code><a href="PPC-test-statistics.html">ppc_stat()</a></code> and <code><a href="PPC-test-statistics.html">ppc_stat_grouped()</a></code> can visualize discrete test statistics
with predictive checks when <code>discrete = TRUE</code>.</p></li>
<li><p><code><a href="PPD-test-statistics.html">ppd_stat()</a></code> and <code><a href="PPD-test-statistics.html">ppd_stat_grouped()</a></code> can visualize discrete test statistics
from predictive draws when <code>discrete = TRUE</code>.</p></li>
<li><p><a href="PPC-distributions.html">ppc_ecdf_overlay</a> can visualize empirical CDFs for discrete statistics
with <code>discrete = TRUE</code>.</p></li>
<li><p><code><a href="PPC-distributions.html">ppc_pit_ecdf()</a></code> and <code><a href="PPC-distributions.html">ppc_pit_ecdf_grouped()</a></code> can also handle discrete
variables to plot PIT-ECDF of the empirical PIT values.</p></li>
</ul><p>These functions are not limited to discrete outcomes, but offer discrete-friendly
displays for integer-valued statistics.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kleiber, C. and Zeileis, A. (2016).
Visualizing count data regressions using rootograms.
<em>The American Statistician</em>. 70(3): 296–303.
<a href="https://arxiv.org/abs/1605.01311" class="external-link">https://arxiv.org/abs/1605.01311</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other PPCs:
<code><a href="PPC-censoring.html">PPC-censoring</a></code>,
<code><a href="PPC-distributions.html">PPC-distributions</a></code>,
<code><a href="PPC-errors.html">PPC-errors</a></code>,
<code><a href="PPC-intervals.html">PPC-intervals</a></code>,
<code><a href="PPC-loo.html">PPC-loo</a></code>,
<code><a href="PPC-overview.html">PPC-overview</a></code>,
<code><a href="PPC-scatterplots.html">PPC-scatterplots</a></code>,
<code><a href="PPC-test-statistics.html">PPC-test-statistics</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">9222017</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># bar plots</span></span></span>
<span class="r-in"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">N</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, size <span class="op">=</span> <span class="va">N</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">yrep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fu">f</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">yrep</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 500 100</span>
<span class="r-in"><span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/gl.html" class="external-link">gl</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">50</span>, length <span class="op">=</span> <span class="fl">100</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GroupA"</span>, <span class="st">"GroupB"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="bayesplot-colors.html">color_scheme_set</a></span><span class="op">(</span><span class="st">"mix-pink-blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ppc_bars</span><span class="op">(</span><span class="va">y</span>, <span class="va">yrep</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PPC-discrete-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># split by group, change interval width, and display proportion</span></span></span>
<span class="r-in"><span><span class="co"># instead of count on y-axis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="bayesplot-colors.html">color_scheme_set</a></span><span class="op">(</span><span class="st">"mix-blue-pink"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ppc_bars_grouped</span><span class="op">(</span><span class="va">y</span>, <span class="va">yrep</span>, <span class="va">group</span>, prob <span class="op">=</span> <span class="fl">0.5</span>, freq <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PPC-discrete-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># example for ordinal regression using rstanarm</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/rstanarm/" class="external-link">rstanarm</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/stan_polr.html" class="external-link">stan_polr</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">tobgp</span> <span class="op">~</span> <span class="va">agegp</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">esoph</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"probit"</span>,</span></span>
<span class="r-in"><span>  prior <span class="op">=</span> <span class="fu"><a href="https://mc-stan.org/rstanarm/reference/priors.html" class="external-link">R2</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">"mean"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  init_r <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>  seed <span class="op">=</span> <span class="fl">12345</span>,</span></span>
<span class="r-in"><span>  <span class="co"># cores = 4,</span></span></span>
<span class="r-in"><span>  refresh <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># coded as character, so convert to integer</span></span></span>
<span class="r-in"><span><span class="va">yrep_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mc-stan.org/rstantools/reference/posterior_predict.html" class="external-link">posterior_predict</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">yrep_char</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1          2          3          4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "0-9g/day" "0-9g/day"    "10-19"    "10-19" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">yrep_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">yrep_char</span>, stringsAsFactors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="va">as.integer</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">esoph</span><span class="op">$</span><span class="va">tobgp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ppc_bars</span><span class="op">(</span><span class="va">y_int</span>, <span class="va">yrep_int</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PPC-discrete-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ppc_bars_grouped</span><span class="op">(</span></span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="va">y_int</span>,</span></span>
<span class="r-in"><span>  yrep <span class="op">=</span> <span class="va">yrep_int</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="va">esoph</span><span class="op">$</span><span class="va">agegp</span>,</span></span>
<span class="r-in"><span>  freq<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  prob <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span>  fatten <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PPC-discrete-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># rootograms for counts</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">yrep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">20</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="bayesplot-colors.html">color_scheme_set</a></span><span class="op">(</span><span class="st">"brightblue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ppc_rootogram</span><span class="op">(</span><span class="va">y</span>, <span class="va">yrep</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PPC-discrete-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">ppc_rootogram</span><span class="op">(</span><span class="va">y</span>, <span class="va">yrep</span>, prob <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PPC-discrete-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ppc_rootogram</span><span class="op">(</span><span class="va">y</span>, <span class="va">yrep</span>, style <span class="op">=</span> <span class="st">"hanging"</span>, prob <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PPC-discrete-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">ppc_rootogram</span><span class="op">(</span><span class="va">y</span>, <span class="va">yrep</span>, style <span class="op">=</span> <span class="st">"suspended"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PPC-discrete-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">ppc_rootogram</span><span class="op">(</span><span class="va">y</span>, <span class="va">yrep</span>, style <span class="op">=</span> <span class="st">"discrete"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PPC-discrete-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonah Gabry, Tristan Mahr.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

