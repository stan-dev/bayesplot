<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting MCMC draws using the bayesplot package • bayesplot</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Plotting MCMC draws using the bayesplot package">
<meta property="og:description" content="">
<meta property="og:image" content="https://mc-stan.org/bayesplot/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bayesplot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Other Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://mc-stan.org/rstan">rstan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstanarm">rstanarm</a>
    </li>
    <li>
      <a href="https://mc-stan.org/shinystan">shinystan</a>
    </li>
    <li>
      <a href="https://mc-stan.org/loo">loo</a>
    </li>
    <li>
      <a href="https://mc-stan.org/projpred">projpred</a>
    </li>
    <li>
      <a href="https://mc-stan.org/rstantools">rstantools</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://mc-stan.org">Stan</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/mcmc_stan">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/stan-dev/bayesplot">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://discourse.mc-stan.org/">
    <span class="fa fa-users"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Plotting MCMC draws using the bayesplot package</h1>
                        <h4 class="author">Jonah Gabry</h4>
            
            <h4 class="date">Latest version: 2019-05-24</h4>
      
      
      <div class="hidden name"><code>plotting-mcmc-draws.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This vignette focuses on plotting parameter estimates from MCMC draws. MCMC diagnostic plots are covered in the separate vignette <a href="https://mc-stan.org/bayesplot/articles/visual-mcmc-diagnostics.html"><em>Visual MCMC diagnostics</em></a>, and graphical posterior predictive model checking is covered in the vignette <a href="https://mc-stan.org/bayesplot/articles/graphical-ppcs.html"><em>Graphical posterior predictive checks</em></a>.</p>
<div id="setup" class="section level3">
<h3 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h3>
<p>In addition to <strong>bayesplot</strong> we’ll load the following packages:</p>
<ul>
<li>
<strong>ggplot2</strong>, in case we want to customize the ggplot objects created by <strong>bayesplot</strong>
</li>
<li>
<strong>rstanarm</strong>, for fitting the example models used throughout the vignette</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"bayesplot"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"ggplot2"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(<span class="st">"rstanarm"</span>)      </a></code></pre></div>
</div>
<div id="example-model" class="section level3">
<h3 class="hasAnchor">
<a href="#example-model" class="anchor"></a>Example model</h3>
<p>The <strong>bayesplot</strong> package provides various plotting functions for visualizing Markov chain Monte Carlo (MCMC) draws from the posterior distribution of the parameters of a Bayesian model.</p>
<p>In this vignette we’ll use draws obtained using the <code>stan_glm</code> function in the <strong>rstanarm</strong> package (Gabry and Goodrich, 2017), but MCMC draws from using any package can be used with the functions in the <strong>bayesplot</strong> package. See, for example, <strong>brms</strong>, which, like <strong>rstanarm</strong>, calls the <strong>rstan</strong> package internally to use <a href="https://mc-stan.org/">Stan</a>’s MCMC sampler.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(mtcars) <span class="co"># see help("mtcars")</span></a></code></pre></div>
<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># linear regression model using stan_glm</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co"># using '~ .' to include all variables</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">fit &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/rstanarm/topics/stan_glm">stan_glm</a></span>(mpg <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> mtcars, <span class="dt">seed =</span> <span class="dv">1111</span>)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(fit)</a></code></pre></div>
<pre><code>stan_glm
 family:       gaussian [identity]
 formula:      mpg ~ .
 observations: 32
 predictors:   11
------
            Median MAD_SD
(Intercept) 12.6   20.1  
cyl         -0.1    1.1  
disp         0.0    0.0  
hp           0.0    0.0  
drat         0.8    1.7  
wt          -3.7    1.9  
qsec         0.8    0.8  
vs           0.3    2.1  
am           2.5    2.1  
gear         0.6    1.6  
carb        -0.2    0.9  

Auxiliary parameter(s):
      Median MAD_SD
sigma 2.7    0.4   

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
<p>To use the posterior draws with the functions in the <strong>bayesplot</strong> package we’ll extract them from the fitted model object:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">posterior &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/array">as.array</a></span>(fit)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dim">dim</a></span>(posterior)</a></code></pre></div>
<pre><code>[1] 1000    4   12</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/dimnames">dimnames</a></span>(posterior)</a></code></pre></div>
<pre><code>$iterations
NULL

$chains
[1] "chain:1" "chain:2" "chain:3" "chain:4"

$parameters
 [1] "(Intercept)" "cyl"         "disp"        "hp"          "drat"       
 [6] "wt"          "qsec"        "vs"          "am"          "gear"       
[11] "carb"        "sigma"      </code></pre>
<p>We’ve used <code>as.array</code> above (as opposed to <code>as.matrix</code>) because it keeps the Markov chains separate (<code>stan_glm</code> runs four chains by default). Most of the plots don’t actually need the chains to be separate, but for a few of the plots we make in this vignette we’ll want to show the chains individually.</p>
<p><br></p>
</div>
</div>
<div id="posterior-uncertainty-intervals" class="section level2">
<h2 class="hasAnchor">
<a href="#posterior-uncertainty-intervals" class="anchor"></a>Posterior uncertainty intervals</h2>
<p>For models fit using MCMC we can compute posterior uncertainty intervals (sometimes called “credible intervals”) in various ways. <strong>bayesplot</strong> currently provides plots of central intervals based on quantiles, although additional options may be provided in future releases (e.g., HDIs, which can be useful in particular cases).</p>
<p><strong>Documentation:</strong></p>
<ul>
<li><code><a href="https://www.rdocumentation.org/packages/utils/topics/help">help("MCMC-intervals")</a></code></li>
<li><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html">mc-stan.org/bayesplot/reference/MCMC-intervals</a></li>
</ul>
<hr>
<div id="mcmc_intervals-mcmc_areas" class="section level4">
<h4 class="hasAnchor">
<a href="#mcmc_intervals-mcmc_areas" class="anchor"></a>mcmc_intervals, mcmc_areas</h4>
<p>Central posterior uncertainty intervals can be plotted using the <code>mcmc_intervals</code> function.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span>(<span class="st">"red"</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="../reference/MCMC-intervals.html">mcmc_intervals</a></span>(posterior, <span class="dt">pars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"cyl"</span>, <span class="st">"drat"</span>, <span class="st">"am"</span>, <span class="st">"sigma"</span>))</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_intervals-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>The default is to show 50% intervals (the thick segments) and 90% intervals (the thinner outer lines). These defaults can be changed using the <code>prob</code> and <code>prob_outer</code> arguments, respectively. The points in the above plot are posterior medians. The <code>point_est</code> argument can be used to select posterior means instead or to omit the point estimates.</p>
<p>To show the uncertainty intervals as shaded areas under the estimated posterior density curves we can use the <code>mcmc_areas</code> function.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="../reference/MCMC-intervals.html">mcmc_areas</a></span>(</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  posterior,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  <span class="dt">pars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"cyl"</span>, <span class="st">"drat"</span>, <span class="st">"am"</span>, <span class="st">"sigma"</span>),</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  <span class="dt">prob =</span> <span class="fl">0.8</span>, <span class="co"># 80% intervals</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  <span class="dt">prob_outer =</span> <span class="fl">0.99</span>, <span class="co"># 99%</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  <span class="dt">point_est =</span> <span class="st">"mean"</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7">)</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_areas-1.png" width="60%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
</div>
<div id="univariate-marginal-posterior-distributions" class="section level2">
<h2 class="hasAnchor">
<a href="#univariate-marginal-posterior-distributions" class="anchor"></a>Univariate marginal posterior distributions</h2>
<p><strong>bayesplot</strong> provides functions for looking at histograms or kernel density estimates of marginal posterior distributions, either with all Markov chains combined or with the chains separate.</p>
<p><strong>Documentation:</strong></p>
<ul>
<li><code><a href="https://www.rdocumentation.org/packages/utils/topics/help">help("MCMC-distributions")</a></code></li>
<li><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html">mc-stan.org/bayesplot/reference/MCMC-distributions</a></li>
</ul>
<hr>
<div id="mcmc_hist" class="section level4">
<h4 class="hasAnchor">
<a href="#mcmc_hist" class="anchor"></a>mcmc_hist</h4>
<p>The <code>mcmc_hist</code> function plots marginal posterior distributions (combining all chains):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span>(<span class="st">"green"</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw"><a href="../reference/MCMC-distributions.html">mcmc_hist</a></span>(posterior, <span class="dt">pars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"wt"</span>, <span class="st">"sigma"</span>))</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_hist-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>If we want to plot <code><a href="https://www.rdocumentation.org/packages/base/topics/Log">log(sigma)</a></code> rather than <code>sigma</code> we can either transform the draws in advance or use the <code>transformations</code> argument.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span>(<span class="st">"blue"</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw"><a href="../reference/MCMC-distributions.html">mcmc_hist</a></span>(posterior, <span class="dt">pars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"wt"</span>, <span class="st">"sigma"</span>),</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">          <span class="dt">transformations =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="st">"sigma"</span> =<span class="st"> "log"</span>))</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_hist-transform-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>Most of the other functions for plotting MCMC draws also have a <code>transformations</code> argument.</p>
</div>
<div id="mcmc_hist_by_chain" class="section level4">
<h4 class="hasAnchor">
<a href="#mcmc_hist_by_chain" class="anchor"></a>mcmc_hist_by_chain</h4>
<p>To view separate histograms of each of the four Markov chains we can use <code>mcmc_hist_by_chain</code>, which plots each chain in a separate facet in the plot.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span>(<span class="st">"brightblue"</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw"><a href="../reference/MCMC-distributions.html">mcmc_hist_by_chain</a></span>(posterior, <span class="dt">pars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"wt"</span>, <span class="st">"sigma"</span>))</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_hist_by_chain-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div id="mcmc_dens" class="section level4">
<h4 class="hasAnchor">
<a href="#mcmc_dens" class="anchor"></a>mcmc_dens</h4>
<p>The <code>mcmc_dens</code> function is similar to <code>mcmc_hist</code> but plots kernel density estimates instead of histograms.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span>(<span class="st">"purple"</span>)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="kw"><a href="../reference/MCMC-distributions.html">mcmc_dens</a></span>(posterior, <span class="dt">pars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"wt"</span>, <span class="st">"sigma"</span>))</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_dens-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div id="mcmc_dens_overlay" class="section level4">
<h4 class="hasAnchor">
<a href="#mcmc_dens_overlay" class="anchor"></a>mcmc_dens_overlay</h4>
<p>Like <code>mcmc_hist_by_chain</code>, the <code>mcmc_dens_overlay</code> function separates the Markov chains. But instead of plotting each chain individually, the density estimates are overlaid.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../reference/MCMC-distributions.html">mcmc_dens_overlay</a></span>(posterior, <span class="dt">pars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"wt"</span>, <span class="st">"sigma"</span>))</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_dens_overlay-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div id="mcmc_violin" class="section level4">
<h4 class="hasAnchor">
<a href="#mcmc_violin" class="anchor"></a>mcmc_violin</h4>
<p>The <code>mcmc_violin</code> function plots the density estimates of each chain as violins and draws horizontal line segments at user-specified quantiles.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span>(<span class="st">"teal"</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw"><a href="../reference/MCMC-distributions.html">mcmc_violin</a></span>(posterior, <span class="dt">pars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"wt"</span>, <span class="st">"sigma"</span>), <span class="dt">probs =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>))</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_violin-1.png" width="60%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
</div>
<div id="bivariate-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#bivariate-plots" class="anchor"></a>Bivariate plots</h2>
<p>Various functions are available for plotting bivariate marginal posterior distributions. Some of these functions also take optional arguments for adding MCMC diagnostic information to the plots. That additional functionality is discussed in the separate <a href="https://mc-stan.org/bayesplot/articles/visual-mcmc-diagnostics.html"><em>Visual MCMC diagnostics</em></a> vignette.</p>
<p><strong>Documentation:</strong></p>
<ul>
<li><code><a href="https://www.rdocumentation.org/packages/utils/topics/help">help("MCMC-scatterplots")</a></code></li>
<li><a href="https://mc-stan.org/bayesplot/reference/MCMC-scatterplots.html">mc-stan.org/bayesplot/reference/MCMC-scatterplots</a></li>
</ul>
<hr>
<div id="mcmc_scatter" class="section level4">
<h4 class="hasAnchor">
<a href="#mcmc_scatter" class="anchor"></a>mcmc_scatter</h4>
<p>The <code>mcmc_scatter</code> function creates a simple scatterplot of two parameters.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span>(<span class="st">"gray"</span>)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2"><span class="kw"><a href="../reference/MCMC-scatterplots.html">mcmc_scatter</a></span>(posterior, <span class="dt">pars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"(Intercept)"</span>, <span class="st">"wt"</span>),</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">             <span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_scatter-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div id="mcmc_hex" class="section level4">
<h4 class="hasAnchor">
<a href="#mcmc_hex" class="anchor"></a>mcmc_hex</h4>
<p>The <code>mcmc_hex</code> function creates a similar plot but using hexagonal binning, which can be useful to avoid overplotting.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># requires hexbin package</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="cf">if</span> (<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ns-load">requireNamespace</a></span>(<span class="st">"hexbin"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)) {</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">  <span class="kw"><a href="../reference/MCMC-scatterplots.html">mcmc_hex</a></span>(posterior, <span class="dt">pars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"(Intercept)"</span>, <span class="st">"wt"</span>))</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">}</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_hex-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div id="mcmc_pairs" class="section level4">
<h4 class="hasAnchor">
<a href="#mcmc_pairs" class="anchor"></a>mcmc_pairs</h4>
<p>In addition to <code>mcmc_scatter</code> and <code>mcmc_hex</code>, <strong>bayesplot</strong> now provides an <code>mcmc_pairs</code> function for creating pairs plots with more than two parameters.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span>(<span class="st">"pink"</span>)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="kw"><a href="../reference/MCMC-scatterplots.html">mcmc_pairs</a></span>(posterior, <span class="dt">pars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"(Intercept)"</span>, <span class="st">"wt"</span>, <span class="st">"sigma"</span>),</a>
<a class="sourceLine" id="cb20-3" data-line-number="3">           <span class="dt">off_diag_args =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">size =</span> <span class="fl">1.5</span>))</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_pairs-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>The univariate marginal posteriors are shown along the diagonal as histograms, but this can be changed to densities by setting <code>diag_fun="dens"</code>. Bivariate plots are displayed above and below the diagonal as scatterplots, but it is also possible to use hex plots by setting <code>off_diag_fun="hex"</code>. By default, <code>mcmc_pairs</code> shows some of the Markov chains (half, if an even number of chains) above the diagonal and the others below. There are many more options for controlling how the draws should be split between the plots above and below the diagonal (see the documentation for the <code>condition</code> argument), but they are more useful when MCMC diagnostic information is included. This is discussed in the <a href="https://mc-stan.org/bayesplot/articles/visual-mcmc-diagnostics.html"><em>Visual MCMC diagnostics</em></a> vignette.</p>
<p><br></p>
</div>
</div>
<div id="trace-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#trace-plots" class="anchor"></a>Trace plots</h2>
<p>Trace plots are time series plots of Markov chains. In this vignette we show the standard trace plots that <strong>bayesplot</strong> can make. For models fit using any Stan interface (or Hamiltonian Monte Carlo in general), the <a href="https://mc-stan.org/bayesplot/articles/visual-mcmc-diagnostics.html"><em>Visual MCMC diagnostics</em></a> vignette provides an example of also adding information about divergences to trace plots.</p>
<p><strong>Documentation:</strong></p>
<ul>
<li><code><a href="https://www.rdocumentation.org/packages/utils/topics/help">help("MCMC-traces")</a></code></li>
<li><a href="https://mc-stan.org/bayesplot/reference/MCMC-traces.html">mc-stan.org/bayesplot/reference/MCMC-traces</a></li>
</ul>
<hr>
<div id="mcmc_trace" class="section level4">
<h4 class="hasAnchor">
<a href="#mcmc_trace" class="anchor"></a>mcmc_trace</h4>
<p>The <code>mcmc_trace</code> function creates standard trace plots:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span>(<span class="st">"blue"</span>)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw"><a href="../reference/MCMC-traces.html">mcmc_trace</a></span>(posterior, <span class="dt">pars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"wt"</span>, <span class="st">"sigma"</span>))</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_trace-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>If it’s hard to see the difference between the chains we can change to a mixed color scheme, for example:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span>(<span class="st">"mix-blue-red"</span>)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw"><a href="../reference/MCMC-traces.html">mcmc_trace</a></span>(posterior, <span class="dt">pars =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"wt"</span>, <span class="st">"sigma"</span>),</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">           <span class="dt">facet_args =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">strip.position =</span> <span class="st">"left"</span>))</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/change-scheme-1.png" width="60%" style="display: block; margin: auto;"></p>
<p>The code above also illustrates the use of the <code>facet_args</code> argument, which is a list of parameters passed to <code>facet_wrap</code> in <strong>ggplot2</strong>. Specifying <code>ncol=1</code> means the trace plots will be stacked in a single column rather than placed side by side, and <code>strip.position="left"</code> moves the facet labels to the y-axis (instead of above each facet).</p>
<p>The <a href="https://CRAN.R-project.org/package=viridis"><code>"viridis"</code> color scheme</a> is also useful for trace plots because it is comprised of very distinct colors:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw"><a href="../reference/bayesplot-colors.html">color_scheme_set</a></span>(<span class="st">"viridis"</span>)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="kw"><a href="../reference/MCMC-traces.html">mcmc_trace</a></span>(posterior, <span class="dt">pars =</span> <span class="st">"(Intercept)"</span>)</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/viridis-scheme-1.png" width="60%" style="display: block; margin: auto;"></p>
</div>
<div id="mcmc_trace_highlight" class="section level4">
<h4 class="hasAnchor">
<a href="#mcmc_trace_highlight" class="anchor"></a>mcmc_trace_highlight</h4>
<p>The <code>mcmc_trace_highlight</code> function uses points instead of lines and reduces the opacity of all but a single chain (which is specified using the <code>highlight</code> argument).</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="../reference/MCMC-traces.html">mcmc_trace_highlight</a></span>(posterior, <span class="dt">pars =</span> <span class="st">"sigma"</span>, <span class="dt">highlight =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="plotting-mcmc-draws_files/figure-html/mcmc_trace_highlight-1.png" width="60%" style="display: block; margin: auto;"></p>
<p><br></p>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Gabry, J., and Goodrich, B. (2017). rstanarm: Bayesian Applied Regression Modeling via Stan. R package version 2.15.3. <a href="https://mc-stan.org/rstanarm" class="uri">https://mc-stan.org/rstanarm</a>, <a href="https://CRAN.R-project.org/package=rstanarm" class="uri">https://CRAN.R-project.org/package=rstanarm</a></p>
<p>Gabry, J. , Simpson, D. , Vehtari, A. , Betancourt, M. and Gelman, A. (2019), Visualization in Bayesian workflow. <em>J. R. Stat. Soc. A</em>, 182: 389-402. :10.1111/rssa.12378. (<a href="https://rss.onlinelibrary.wiley.com/doi/full/10.1111/rssa.12378">journal version</a>, <a href="https://arxiv.org/abs/1709.01449">arXiv preprint</a>, <a href="https://github.com/jgabry/bayes-vis-paper">code on GitHub</a>) <a id="gabry2019"></a></p>
<p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., and Rubin, D. B. (2013). <em>Bayesian Data Analysis</em>. Chapman &amp; Hall/CRC Press, London, third edition.</p>
<p>Stan Development Team. (2017). <em>Stan Modeling Language Users Guide and Reference Manual</em>. <a href="https://mc-stan.org/users/documentation/" class="uri">https://mc-stan.org/users/documentation/</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#posterior-uncertainty-intervals">Posterior uncertainty intervals</a></li>
      <li><a href="#univariate-marginal-posterior-distributions">Univariate marginal posterior distributions</a></li>
      <li><a href="#bivariate-plots">Bivariate plots</a></li>
      <li><a href="#trace-plots">Trace plots</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jonah Gabry, Tristan Mahr.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '28ab84fbf0d3f58232875561b9a208cd',
    indexName: 'bayesplot',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
